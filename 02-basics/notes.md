# C++ Basic Concepts

## Expression
在编程语言和计算机科学中，Precedence（优先级）、Associativity（结合性） 和 Order（求值顺序） 是三个关键概念，用于定义表达式中运算符和操作数的行为。以下是它们的详细解释和区别：

---

1. **Precedence（优先级）**
• 定义：运算符的优先级决定了表达式中运算符的执行顺序。优先级高的运算符会先于优先级低的运算符被计算。

• 作用：解决“先算乘除还是先算加减”这类问题。

• 示例：

  • 在数学和大多数编程语言中，`*` 和 `/` 的优先级高于 `+` 和 `-`。

  • 表达式 `2 + 3 * 4` 会被解析为 `2 + (3 * 4)`，结果是 `14`，而非 `(2 + 3) * 4 = 20`。


---

2. **Associativity（结合性）**
• 定义：当表达式中出现多个相同优先级的运算符时，结合性决定了它们的计算方向（从左到右或从右到左）。

• 分类：

  • 左结合（Left-associative）：从左向右计算（常见于大多数运算符）。

    ◦ 例如：`a - b - c` 等价于 `(a - b) - c`。

  • 右结合（Right-associative）：从右向左计算（如赋值运算符、指数运算）。

    ◦ 例如：`a = b = c` 等价于 `a = (b = c)`。

    ◦ 在数学中，`2^3^4` 通常解析为 `2^(3^4)`（右结合）。

• 作用：解决优先级相同时的计算顺序问题。


---

3. **Order（求值顺序）**
• 定义：指表达式中操作数（operands）的求值顺序（注意：不是运算符的顺序！）。

• 关键点：

  • 与优先级和结合性不同，求值顺序通常由语言规范定义，且可能因语言而异。

  • 例如，在表达式 `f(a) + g(b)` 中：

    ◦ `f(a)` 和 `g(b)` 的调用顺序可能是任意的（取决于语言规范）。

    ◦ 在C/C++中，求值顺序是未定义的（编译器决定），而在Java/Python中通常是从左到右。

• 常见误区：

  • 优先级和结合性仅决定运算符的执行顺序，不决定操作数的求值顺序。

  • 例如：`a() * b() + c()` 中，`*` 优先级高于 `+`，但 `a()`、`b()`、`c()` 的调用顺序可能任意。


---

三者的关系与区别
| 概念          | 作用对象       | 解决的问题                     | 示例                          |
|---------------|----------------|------------------------------|-------------------------------|
| Precedence | 运算符         | 哪个运算符先计算？            | `2 + 3 * 4` → `3 * 4` 先算    |
| Associativity | 同级运算符 | 同级运算符按什么方向计算？     | `a - b - c` → 左结合，`(a - b) - c` |
| Order      | 操作数         | 操作数的求值顺序是否固定？     | `f() + g()` 中 `f()` 和 `g()` 的调用顺序 |

---

实际应用中的注意事项
1. 优先级陷阱：  
   • 例如 `&` 和 `==` 的优先级问题：`if (x & 1 == 0)` 在C中会被解析为 `x & (1 == 0)`（因为 `==` 优先级高于 `&`），通常需要括号明确意图：`if ((x & 1) == 0)`。


2. 结合性陷阱：  
   • 如 `a = b = 1` 是右结合（`a = (b = 1)`），而 `a / b / c` 是左结合（`(a / b) / c`）。


3. 求值顺序的副作用：  
   • 在 `arr[i] = i++` 中（C/C++），由于求值顺序未定义，结果可能是未定义的。


---
