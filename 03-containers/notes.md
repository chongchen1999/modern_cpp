
# Iterators

在C++中，迭代器（Iterator）是STL（标准模板库）的核心组件之一，用于遍历容器中的元素。根据功能和访问方式的不同，C++迭代器分为六种类型，每种类型支持不同的操作。以下是它们的详细介绍：

---

1. **输入迭代器（Input Iterator）**
• 功能：只读访问容器中的元素，且只能单向向前移动（`++`）。

• 支持操作：

  • 解引用（`*it`）获取值（但不能修改）。

  • 比较（`==`, `!=`）。

  • 自增（`++`）。

• 典型应用：`istream_iterator`（从输入流读取数据）。

• 限制：不能保证多次遍历的有效性（遍历后可能失效）。


```cpp
std::istream_iterator<int> input(std::cin);
int value = *input; // 读取输入的值
```

---

2. **输出迭代器（Output Iterator）**
• 功能：只写访问容器中的元素，单向向前移动。

• 支持操作：

  • 解引用（`*it`）用于赋值（但不能读取）。

  • 自增（`++`）。

• 典型应用：`ostream_iterator`（向输出流写入数据）。

• 限制：不能读取元素，且不能保证多次遍历的有效性。


```cpp
std::ostream_iterator<int> output(std::cout, " ");
*output = 42; // 向cout写入42
```

---

3. **前向迭代器（Forward Iterator）**
• 功能：支持读写访问，单向向前移动，但允许多次遍历。

• 支持操作：

  • 解引用（读写）。

  • 自增（`++`）。

  • 比较（`==`, `!=`）。

• 典型应用：`std::forward_list`、哈希容器（如`unordered_set`）。

• 特点：比输入/输出迭代器更强，可重复使用。


```cpp
std::forward_list<int> lst = {1, 2, 3};
auto it = lst.begin();
*it = 10; // 修改元素
```

---

4. **双向迭代器（Bidirectional Iterator）**
• 功能：在前向迭代器基础上增加反向移动（`--`）。

• 支持操作：

  • 自增（`++`）和自减（`--`）。

  • 其他同前向迭代器。

• 典型应用：`std::list`、`std::set`、`std::map`等。

• 特点：支持双向遍历。


```cpp
std::list<int> lst = {1, 2, 3};
auto it = lst.end();
--it; // 移动到最后一个元素
```

---

5. **随机访问迭代器（Random Access Iterator）**
• 功能：支持直接跳跃访问任意位置（类似指针）。

• 支持操作：

  • 算术运算（`+`, `-`, `+=`, `-=`）。

  • 关系比较（`<`, `>`, `<=`, `>=`）。

  • 下标访问（`it[n]`）。

• 典型应用：`std::vector`、`std::deque`、原生数组。

• 特点：效率最高，支持复杂操作。


```cpp
std::vector<int> vec = {1, 2, 3};
auto it = vec.begin();
int third = *(it + 2); // 直接访问第3个元素
```

---

6. **连续迭代器（Contiguous Iterator，C++17引入）**
• 功能：随机访问迭代器的特例，保证元素在内存中连续存储。

• 支持操作：同随机访问迭代器。

• 典型应用：`std::vector`、`std::array`、原生数组。

• 特点：可通过指针算术直接访问底层内存。


```cpp
std::array<int, 3> arr = {1, 2, 3};
int* ptr = arr.data(); // 获取指向连续内存的指针
```

---

迭代器类别的关系
• 层次结构：  

  `输入/输出` → `前向` → `双向` → `随机访问` → `连续`  
  高级迭代器支持低级迭代器的所有操作。

• 使用建议：  

  根据容器类型选择最高效的迭代器。例如：  
  • `vector`：随机访问迭代器。  

  • `list`：双向迭代器。  

  • `unordered_map`：前向迭代器。


---

总结
| 迭代器类型       | 读写能力 | 移动方向   | 多遍遍历 | 典型容器               |
|------------------|----------|------------|----------|------------------------|
| 输入迭代器       | 只读     | 单向（前） | 否       | `istream_iterator`     |
| 输出迭代器       | 只写     | 单向（前） | 否       | `ostream_iterator`     |
| 前向迭代器       | 读写     | 单向（前） | 是       | `forward_list`         |
| 双向迭代器       | 读写     | 双向       | 是       | `list`, `set`, `map`   |
| 随机访问迭代器   | 读写     | 任意跳跃   | 是       | `vector`, `deque`      |
| 连续迭代器       | 读写     | 任意跳跃   | 是       | `array`, 原生数组      |

理解这些迭代器的特性有助于高效使用STL算法（如`sort`需要随机访问迭代器，而`find`仅需输入迭代器）。